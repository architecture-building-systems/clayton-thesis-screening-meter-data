\subsubsection{Seasonality and Trend Decomposition}
\label{sec:seasonaldecomposition}

Temporal, or time series data, from different sources often exhibit similar types of behavior that are studied within the field of forecasting and temporal data mining. Electrical building meter data fits within this category and the same feature extraction techniques can be applied as what is commonly done for financial or social science analysis. These techniques often seek to decompose time-series data into several components that represent the underlying nature of the data \cite{Mitsa_2010}. For example, the electrical meter data collected from buildings is often cyclical in its weekly schedule. People are utilizing buildings each day of the week in a relatively predictable pattern. A very common example of this behavior is found in office buildings where occupants are typical white collar professionals who come into work on weekdays at a certain time and leave to go home at a certain time. Weekends are generally unoccupied periods in which there is little to no activity. This behavior is an example of what's known as seasonality within time series analysis. Seasonality is a fixed an known period of consistent modulation and is a feature that is often extracted before creating predictive models. 

Trends are another feature commonly found in temporal data. A trend is a long term increase or decrease in the data that often doesn't follow a certain pattern. Trends are commonly due to factors that are less systematic than seasonality and are often due to external influences. For building energy consumption, trends manifest themselves as gradual shifts in consumption over the course of week or months. Often these shifts are due to weather-related factors having an influence on the HVAC equipment. Other causes of trends are changes in occupancy of degradation of system efficiency. 

In order to capture these features to understand their impact on characterizing buildings, the seasonal-trend decomposition procedure based on loess is used to extract each of these features from the case study buildings \cite{cleveland1990stl}. This process is used to extract the weekly \emph{seasonal} patterns from each building, the long-term trend over time, and the residual remainders from the model developed by those two components. The input data is aggregated to daily summations and weather normalized by subtracting the calculated heating and cooling components from the change point model described in Section \ref{sec:changepointmodels}. This step is done to reduce the influence weather plays in the trend decomposition. The \emph{STL} package in R is used for this process to extract the seasonal, trend, and irregular components \footnote{https://stat.ethz.ch/R-manual/R-devel/library/stats/html/stl.html}. 

The details of the inner algorithms of the \emph{STL} procedure are described by Cleveland et al. \cite{cleveland1990stl}. The process uses an inner loop of algorithms to detrend and deseasonalize the data by creating a trend component, $T_v$, and a seasonal component, $S_v$. The remainder component, $R_v$, is a subtraction of the input values, $Y_v$ as seen in Equation \ref{stl_residualscalc}. An output of the process in this library is seen in Figure \ref{fig:stl_decomposition}. 

\begin{equation}
\label{eq:stl_residualscalc}
R_v = Y_v - T_v - S_v
\end{equation}

